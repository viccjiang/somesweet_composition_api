import{O as H,a as N,r as f,o as J,e as o,f as n,g as t,l as e,j as d,t as _,_ as X,B as Q,u as Y,s as K,d as S,h as v,L as F,m as u,i as k,F as D,n as U,q,v as tt,z as et,k as A,N as ot,x as st,y as nt}from"./index-52e2f2b0.js";import{M as at}from"./modal-ddb9eb11.js";import{U as dt}from"./UserCartStepComponent-0a9b2ac3.js";import"./component-functions-3e43fe49.js";import"./selector-engine-85b27f3a.js";import"./focustrap-ed59e4cd.js";const lt={class:"modal-dialog modal-dialog-centered"},ct={class:"modal-content border-0"},rt={key:0,class:"modal-body"},it={class:"text-danger"},ut={key:1,class:"modal-body"},_t=t("span",{class:"text-danger fw-bold"},"全部商品",-1),pt={class:"modal-footer"},ht=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),bt={__name:"UserCartDelModal",props:{product:{type:null}},setup(p){const C=p,{product:h}=H(C),w=N(),{deleteItem:B,deleteAllItem:x,setModal:M}=w,i=f(null);return J(()=>{M(new at(i.value))}),(V,c)=>{var P,y;return o(),n("div",{id:"delProductModal",ref_key:"delmodal",ref:i,class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},[t("div",lt,[t("div",ct,[e(h).id?(o(),n("div",rt,[d(" 是否刪除 "),t("strong",it,_((y=(P=e(h))==null?void 0:P.product)==null?void 0:y.title),1),d(" 商品 ")])):(o(),n("div",ut,[d(" 是否刪除 "),_t])),t("div",pt,[ht,e(h).id?(o(),n("button",{key:0,type:"button",class:"btn btn-danger text-white",onClick:c[0]||(c[0]=$=>e(B)(e(h).id))}," 確認刪除 ")):(o(),n("button",{key:1,type:"button",class:"btn btn-danger text-white",onClick:c[1]||(c[1]=(...$)=>e(x)&&e(x)(...$))}," 確認刪除 "))])])])],512)}}};const r=p=>(st("data-v-8c61bfe2"),p=p(),nt(),p),gt={key:1,class:"text-center"},mt={class:"card border-0 rounded-0 bg-dark text-white"},vt=r(()=>t("img",{style:{height:"70vh","background-image":"url(https://storage.googleapis.com/vue-course-api.appspot.com/jiangs2023/1678158943058.jpg?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=Jn44%2B%2Bkd2gsFMtS91bnOaxSgmiZ1%2Byv%2B9wCGscJsTeCPU%2FnJc9ZMY5OM9AHec%2FYg0WQ%2BBMf2MqVBex%2Buondfr5cs8qgrLhRaqjzancMVsdSQh7%2Bt%2Bvve3ZpNoGtFIw29HggFVxqpBmJfWJU43sheDg966D5usj5PlkswQ7xutpIJwBZSAu4tuYZ%2BhVszThrE3rXRR9BRRfXvRxgiJpPlrlg3XxAbSE%2BvNgwq4iRl11eaE5fXuWGI8nRu4ORW%2FhG1SBtgGsYb0TAJ4jFPxNlDKjmI%2FBal2WrWD32jtOjvsSUbtxatHQ5OKx0vos6oW%2BIonUawlg6B%2FsNcChWBXVxDZw%3D%3D)","background-size":"cover","background-position":"center bottom","object-fit":"cover","background-attachment":"fixed","background-blend-mode":"multiply","background-color":"rgba(0, 0, 0, 0.6)"}},null,-1)),ft={class:"card-img-overlay d-flex flex-column justify-content-center align-item-center"},xt={class:"card-title text-center"},yt=r(()=>t("br",null,null,-1)),kt={class:"d-flex align-items-center justify-content-center mt-5"},Ct={type:"button",class:"btn btn-outline-secondary me-5"},wt={type:"button",class:"btn btn-light"},Bt={key:2,class:"container"},Pt={class:"text-end mb-7"},$t=r(()=>t("i",{class:"bi bi-trash3 text-danger me-2"},null,-1)),Dt={class:"table align-middle table-hover"},Mt=r(()=>t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"100px"}},"數量"),t("th",{class:"text-end"},"單價"),t("th")])],-1)),Vt={style:{width:"15%"}},It=["onClick"],Rt=["src"],jt=["onClick"],St={class:"input-group input-group-sm"},Ut=["onUpdate:modelValue","onChange"],At=["value"],Lt=["value"],Tt={class:"text-end"},Et={class:"text-end"},Ft=["onClick"],qt=r(()=>t("i",{class:"bi bi-trash3 text-danger"},null,-1)),Nt=[qt],Jt=r(()=>t("td",{colspan:"3",class:"text-end"},"總計",-1)),Ot={class:"text-end"},Wt=r(()=>t("td",null,null,-1)),zt=r(()=>t("td",{colspan:"3",class:"text-end text-success"},"折扣完總金額",-1)),Gt={class:"text-end text-success"},Zt=r(()=>t("td",null,null,-1)),Ht={class:"row justify-content-end"},Xt={class:"col-12 col-md-5"},Qt={class:"coupon input-group mb-3 input-group-sm"},Yt={class:"input-group-append"},Kt={key:3,class:"container mt-10 mb-10"},te={class:"row"},ee={class:"d-flex justify-content-between"},oe={__name:"UserCart",setup(p){const C=Q("$http"),h=Y(),w=N(),{VITE_APP_URL:B,VITE_APP_PATH:x}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet_composition_api/",MODE:"production",DEV:!1,PROD:!0},M=f([]),i=f([]),V=f({}),c=f("");f("");function P(){C.get(`${B}api/${x}/products/all`).then(l=>{console.log("產品列表:",l.data.products),M.value=l.data.products})}function y(l){h.push(`/product/${l}`)}function $(l){i.value={...l},console.log(i),T.value.show()}function O(l){i.value={},V.value={...l},console.log(b.value),T.value.show()}function W(){const l=`${B}api/${x}/coupon`,m={code:c.value};C.post(l,{data:m}).then(R=>{console.log(R),c.value="",L()})}const{getCarts:L,updateCartItem:z,deleteItem:G,toThousands:I}=w,{cartData:b,cartsLength:g,modal:T,isLoading:Z}=K(w);return J(()=>{P(),L()}),(l,m)=>{const R=S("LoadingView"),j=S("RouterLink"),E=S("router-link");return o(),n(D,null,[v(R,{active:e(Z),loader:"bars",color:"#034D83"},null,8,["active"]),e(g)>0?(o(),F(dt,{key:0})):u("",!0),e(g)==0?(o(),n("div",gt,[t("div",mt,[vt,t("div",ft,[t("h2",xt,[d(" 購物車是空的 "),yt,d("請至 "),v(j,{class:"text-light fw-bold",to:"/products"},{default:k(()=>[d("清晨甜點")]),_:1}),d(" 選購 ")]),t("div",kt,[t("button",Ct,[v(j,{class:"text-light",to:"/"},{default:k(()=>[d("返回首頁")]),_:1})]),t("button",wt,[v(j,{class:"text-dark",to:"/products"},{default:k(()=>[d("繼續購物")]),_:1})])])])])])):u("",!0),e(g)>0?(o(),n("div",Bt,[t("div",Pt,[e(g)>0?(o(),n("a",{key:0,class:"border-bottom border-danger text-danger",type:"button",onClick:m[0]||(m[0]=s=>O(e(b)))},[$t,d("清空所有商品")])):u("",!0)]),t("table",Dt,[Mt,t("tbody",null,[e(b).carts?(o(!0),n(D,{key:0},U(e(b).carts,s=>(o(),n("tr",{key:s.id},[t("td",Vt,[t("a",{href:"#",onClick:A(a=>y(s.product.id),["prevent"])},[t("img",{src:s.product.imageUrl,alt:"",class:"object-fit d-none d-md-block rounded-4",style:{width:"100px",height:"100px"}},null,8,Rt)],8,It)]),t("td",null,[t("a",{href:"#",class:"text-dark d-block",onClick:A(a=>y(s.product.id),["prevent"])},_(s.product.title),9,jt)]),t("td",null,[t("div",St,[q(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>s.qty=a,onChange:a=>e(z)(s)},[s.qty<=20?(o(),n(D,{key:0},U(20,a=>t("option",{value:a,key:a+"1234578"},_(a),9,At)),64)):(o(!0),n(D,{key:1},U(s.qty,a=>(o(),n("option",{value:a,key:a+"1234578"},_(a),9,Lt))),128))],40,Ut),[[ot,s.qty]])])]),t("td",Tt,_(e(I)(s.total)),1),t("td",Et,[t("a",{href:"",onClick:A(a=>$(s),["prevent"])},Nt,8,Ft)])]))),128)):u("",!0)]),t("tfoot",null,[t("tr",null,[Jt,t("td",Ot,_(e(I)(e(b).total)),1),Wt]),t("tr",null,[zt,t("td",Gt,_(e(I)(e(b).final_total)),1),Zt])])]),t("div",Ht,[t("div",Xt,[t("div",Qt,[q(t("input",{type:"text",class:"form-control border-0 border-bottom","onUpdate:modelValue":m[1]||(m[1]=s=>c.value=s),placeholder:"請輸入優惠碼"},null,512),[[tt,c.value]]),t("div",Yt,[t("button",{class:et(["btn btn-primary rounded-0 border rounded-4",{disabled:c.value===""}]),type:"button",onClick:W}," 套用優惠碼 ",2)])])])])])):u("",!0),e(g)>0?(o(),n("div",Kt,[t("div",te,[t("div",ee,[v(E,{to:"/products",class:"btn btn-outline-primary px-5 rounded-4"},{default:k(()=>[d("繼續選購")]),_:1}),e(g)>0?(o(),F(E,{key:0,to:"/checkout",class:"btn btn-danger px-5 text-white rounded-4"},{default:k(()=>[d("下一步 ")]),_:1})):u("",!0)])])])):u("",!0),v(bt,{product:i.value,cartData:V.value,ref:"delModal",id:"delModal",onDelProduct:e(G)},null,8,["product","cartData","onDelProduct"])],64)}}},re=X(oe,[["__scopeId","data-v-8c61bfe2"]]);export{re as default};
