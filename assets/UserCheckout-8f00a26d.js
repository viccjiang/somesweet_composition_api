import{u as N,a as q,B as C,r as w,s as D,o as F,d as u,e as h,f,h as s,l as d,g as e,F as y,n as L,t as i,i as b,j as T,z as _,q as R,v as B}from"./index-52e2f2b0.js";import{U as I}from"./UserCartStepComponent-0a9b2ac3.js";const M={class:"bg-light pt-5 pb-7 mt-5"},S={class:"container"},O={class:"row justify-content-center flex-column flex-md-row"},z={class:"col-md-5 sticky-md-top position-md-sticky h-50"},H={class:"border rounded-4 p-4 mb-4"},G=e("h4",{class:"mb-4"},"訂單明細",-1),J=["src"],K={class:"w-100"},Q={class:"d-flex justify-content-between fw-bold"},W={class:"mb-0"},X={class:"mb-0"},Y={class:"d-flex justify-content-between"},Z={class:"text-muted mb-0"},ee={class:"mb-0"},se={class:"table mt-4 border-top border-bottom text-muted"},te=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"原價",-1),oe={class:"text-end border-0 px-0 pt-4"},le=e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"優惠價",-1),ae={class:"text-end border-0 px-0 pt-0 pb-4"},de={class:"d-flex justify-content-between mt-4"},ne=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),ie={class:"mb-0 h4 fw-bold"},re={class:"p-0"},ce={class:""},me={class:"d-none d-md-grid"},ue={class:"col-md-7"},_e={class:"row justify-content-center p-4"},pe=e("h4",{class:"mb-4 text-center text-md-start"},"填寫訂購資訊",-1),be={class:"mb-3"},he=e("label",{for:"email",class:"form-label"},"Email",-1),fe={class:"mb-3"},ve=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),xe={class:"mb-3"},ge=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Ve={class:"mb-3"},we=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ye={class:"mb-3"},Te=e("label",{for:"address",class:"form-label"},"交易方式",-1),ke=e("option",{value:""},"請選擇交易方式",-1),Ue=e("option",{value:"ATM"},"ATM",-1),Pe=e("option",{value:"匯款"},"匯款",-1),Ee=e("option",{value:"信用卡"},"信用卡",-1),$e={class:"mb-5"},je=e("label",{for:"message",class:"form-label"},"留言",-1),Ae=e("div",{class:"text-end d-grid"},[e("button",{type:"submit",class:"btn btn-danger mb-5 text-white rounded-4"},"送出訂單")],-1),De={__name:"UserCheckout",setup(Ne){const k=N(),{VITE_APP_URL:U,VITE_APP_PATH:P}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"jiangs2023",BASE_URL:"/somesweet_composition_api/",MODE:"production",DEV:!1,PROD:!0},v=q(),E=C("$http"),t=w({user:{name:"",email:"",tel:"",address:"",shipping:""},message:""});w([]);function $(){const g=`${U}api/${P}/order`,o=t.value;E.post(g,{data:o}).then(n=>{console.log(n),n.data.success&&(k.push(`/order_payment/${n.data.orderId}`),t.value.resetForm()),x()}).catch(n=>{alert(n.data.message)})}const{getCarts:x,toThousands:r}=v,{cartData:p,isLoading:j}=D(v);return F(()=>{x()}),(g,o)=>{const n=u("LoadingView"),V=u("router-link"),c=u("FieldView"),m=u("error-message"),A=u("FormView");return h(),f(y,null,[s(n,{active:d(j),loader:"bars",color:"#034D83"},null,8,["active"]),s(I),e("div",null,[e("div",M,[e("div",S,[e("div",O,[e("div",z,[e("div",H,[G,(h(!0),f(y,null,L(d(p).carts,l=>(h(),f("div",{class:"d-flex",key:l.id},[e("img",{src:l.product.imageUrl,alt:"",class:"me-2 my-1 w-50",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,J),e("div",K,[e("div",Q,[e("p",W,i(l.product.title),1),e("p",X,"x "+i(l.qty),1)]),e("div",Y,[e("p",Z,[e("small",null,"NT$"+i(d(r)(l.product.price)),1)]),e("p",ee,"NT$"+i(d(r)(l.final_total)),1)])])]))),128)),e("table",se,[e("tbody",null,[e("tr",null,[te,e("td",oe," NT$"+i(d(r)(d(p).total)),1)]),e("tr",null,[le,e("td",ae," NT$"+i(d(r)(d(p).final_total)),1)])])]),e("div",de,[ne,e("p",ie,"NT$"+i(d(r)(d(p).final_total)),1)])]),e("div",re,[e("div",ce,[e("div",me,[s(V,{to:"/cart",class:"btn btn-outline-secondary px-5 mb-5 rounded-4"},{default:b(()=>[T("回上一頁")]),_:1}),s(V,{to:"/products",class:"btn btn-outline-primary px-5 rounded-4"},{default:b(()=>[T("繼續選購")]),_:1})])])])]),e("div",ue,[e("div",_e,[pe,s(A,{class:"border rounded-4 p-10",onSubmit:$},{default:b(({errors:l})=>[e("div",be,[he,s(c,{id:"email",name:"email",label:"信箱",type:"email",class:_(["form-control rounded-3",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.value.user.email,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.user.email=a)},null,8,["class","modelValue"]),s(m,{name:"email",class:"invalid-feedback"})]),e("div",fe,[ve,s(c,{id:"name",name:"name",label:"姓名",type:"text",class:_(["form-control rounded-3",{"is-invalid":l.name}]),rules:"required",modelValue:t.value.user.name,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.user.name=a),placeholder:"請輸入姓名"},null,8,["class","modelValue"]),s(m,{name:"name",class:"invalid-feedback"})]),e("div",xe,[ge,s(c,{id:"tel",name:"tel",label:"電話",type:"text",class:_(["form-control rounded-3",{"is-invalid":l.tel}]),rules:"required|min:8|max:10",modelValue:t.value.user.tel,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.user.tel=a),placeholder:"請輸入電話"},null,8,["class","modelValue"]),s(m,{name:"tel",class:"invalid-feedback"})]),e("div",Ve,[we,s(c,{id:"address",name:"address",label:"地址",type:"text",class:_(["form-control rounded-3",{"is-invalid":l.address}]),rules:"required",modelValue:t.value.user.address,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.user.address=a),placeholder:"請輸入地址"},null,8,["class","modelValue"]),s(m,{name:"address",class:"invalid-feedback"})]),e("div",ye,[Te,s(c,{id:"name",name:"trade",label:"交易方式",class:_(["form-select rounded-3",{"is-invalid":l.trade}]),placeholder:"請輸入交易方式",rules:"required",modelValue:t.value.user.shipping,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.user.shipping=a),as:"select"},{default:b(()=>[ke,Ue,Pe,Ee]),_:2},1032,["class","modelValue"]),s(m,{name:"trade",class:"invalid-feedback"})]),e("div",$e,[je,R(e("textarea",{id:"message",class:"form-control rounded-4",cols:"30",rows:"10","onUpdate:modelValue":o[5]||(o[5]=a=>t.value.user.message=a)},null,512),[[B,t.value.user.message]])]),Ae]),_:1})])])])])])])],64)}}};export{De as default};
